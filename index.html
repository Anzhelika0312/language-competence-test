<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Language Competence!</title>
  <style>
    :root{
      --ok:#1f9d55;
      --bad:#d64545;
      --bg:#f7f7fb;
      --card:#ffffff;
      --text:#111827;
      --muted:#6b7280;
      --border:#e5e7eb;
    }
    body{
      margin:0;
      font-family: Arial, Helvetica, sans-serif;
      background:var(--bg);
      color:var(--text);
      line-height:1.5;
      font-size:18px;
    }
    .wrap{
      max-width:1100px;
      margin:24px auto;
      padding:0 16px 40px;
    }
    h1{ font-size:32px; margin:8px 0 16px; }
    h2{ font-size:26px; margin:22px 0 10px; }
    h3{ font-size:22px; margin:18px 0 8px; }
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:14px;
      padding:18px;
      margin:14px 0;
      box-shadow: 0 1px 0 rgba(0,0,0,0.03);
    }
    .muted{ color:var(--muted); }
    .rule{
      background:#fff;
      border-left:6px solid #111827;
      padding:12px 14px;
      border-radius:10px;
      margin:10px 0 18px;
    }
    details{
      background:#fff;
      border:1px solid var(--border);
      border-radius:14px;
      padding:12px 14px;
      margin:12px 0;
    }
    summary{
      cursor:pointer;
      font-weight:700;
      font-size:20px;
      list-style:none;
      outline:none;
    }
    summary::-webkit-details-marker{ display:none; }
    .passage{
      margin-top:10px;
      white-space:pre-wrap;
      font-size:18px;
    }
    .q{
      padding:12px;
      border:1px solid var(--border);
      border-radius:12px;
      margin:12px 0;
    }
    .q-title{
      font-weight:700;
      margin-bottom:10px;
      font-size:20px;
    }
    .inline-input{
      display:inline-flex;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
    }
    input[type="text"]{
      font-size:20px;
      padding:10px 12px;
      border:2px solid var(--border);
      border-radius:10px;
      width:240px;
      outline:none;
      background:#fff;
    }
    input[type="text"]:focus{
      border-color:#111827;
    }
    .options label{
      display:block;
      padding:8px 10px;
      border:1px solid var(--border);
      border-radius:10px;
      margin:8px 0;
      cursor:pointer;
      font-size:19px;
    }
    .options input{ transform:scale(1.15); margin-right:10px; }
    .scorebar{
      position:sticky;
      top:0;
      z-index:3;
      background:#111827;
      color:#fff;
      padding:12px 14px;
      border-radius:14px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      margin-bottom:14px;
    }
    .btn{
      background:#fff;
      color:#111827;
      border:none;
      border-radius:12px;
      padding:10px 14px;
      font-size:18px;
      font-weight:700;
      cursor:pointer;
    }
    .btn:active{ transform:translateY(1px); }
    .final{
      font-size:22px;
      font-weight:800;
      margin-top:12px;
    }
    .grid2{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
    }
    @media (max-width: 820px){
      .grid2{ grid-template-columns:1fr; }
      input[type="text"]{ width:100%; }
      .scorebar{ flex-direction:column; align-items:flex-start; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="scorebar">
      <div>
        <div class="muted" style="color:#d1d5db;">Language Competence • Online Olympiad</div>

        <div style="margin-top:10px; display:flex; gap:10px; flex-wrap:wrap;">
          <input type="text" id="fullName" placeholder="Full name (ФИО)" style="width:280px; font-size:16px; padding:8px 10px; border-radius:10px; border:none;" />
          <select id="status" style="font-size:16px; padding:8px 10px; border-radius:10px; border:none;">
            <option value="">Select status</option>
            <option value="student">student</option>
            <option value="master’s student">magistrant</option>
            <option value="teacher">teacher</option>
          </select>
        </div>
      </div>

      <div style="display:flex; gap:10px; flex-wrap:wrap;">
        <button class="btn" id="btnFinish">Finish & Show Result</button>
        <button class="btn" id="btnReset">Reset</button>
      </div>
    </div>

    <h1>Language Competence!</h1>

    <div class="rule">
      <b>IMPORTANT:</b> Follow the format strictly:
      <ul style="margin:8px 0 0 22px;">
        <li>Task 1 & Part 3: <b>ONE WORD ONLY</b></li>
        <li>Task 2: choose <b>TWO letters</b></li>
        <li>Part 2: choose <b>ONE option</b></li>
      </ul>
      Incorrect format or spelling = <b>0 points</b>. Your total score will be shown only after you finish.
    </div>

    <!-- PART 1 -->
    <h2>PART 1 — READING</h2>

    <div class="card">
      <h3>Task 1. Note Completion (Qs 1–4) — 4 points</h3>
      <p class="muted">
        Fill each blank with <b>ONE WORD ONLY</b> from the passage. The word must appear exactly in the text.
      </p>

      <details open>
        <summary>THE STEP PYRAMID OF DJOSER (Click to hide/show)</summary>
        <div class="passage" id="passage">
A
The pyramids are the most famous monuments of ancient Egypt and still hold enormous interest for people in the present day. These grand, impressive tributes to the memory of the Egyptian kings have become linked with the country even though other cultures, such as the Chinese and Mayan, also built pyramids. The evolution of the pyramid form has been written and argued about for centuries. However, there is no question that, as far as Egypt is concerned, it began with one monument to one king designed by one brilliant architect: the Step Pyramid of Djoser at Saqqara.

B
Djoser was the first king of the Third Dynasty of Egypt and the first to build in stone. Prior to Djoser’s reign, tombs were rectangular monuments made of dried clay brick, which covered underground passages where the deceased person was buried. For reasons which remain unclear, Djoser’s main official, whose name was Imhotep, conceived of building a taller, more impressive tomb for his king by stacking stone slabs on top of one another, progressively making them smaller, to form the shape now known as the Step Pyramid. Djoser is thought to have reigned for 19 years, but some historians and scholars attribute a much longer time for his rule, owing to the number and size of the monuments he built.

C
The Step Pyramid has been thoroughly examined and investigated over the last century, and it is now known that the building process went through many different stages. Historian Marc Van de Mieroop comments on this, writing ‘Much experimentation was involved, which is especially clear in the construction of the pyramid in the center of the complex. It had several plans … before it became the first Step Pyramid in history, piling six levels on top of one another … The weight of the enormous mass was a challenge for the builders, who placed the stones at an inward incline in order to prevent the monument breaking up.’

D
When finally completed, the Step Pyramid rose 62 meters high and was the tallest structure of its time. The complex in which it was built was the size of a city in ancient Egypt and included a temple, courtyards, shrines, and living quarters for the priests. It covered a region of 16 hectares and was surrounded by a wall 10.5 meters high. The wall had 13 false doors cut into it with only one true entrance cut into the south-east corner; the entire wall was then ringed by a trench 750 meters long and 40 meters wide. The false doors and the trench were incorporated into the complex to discourage unwanted visitors. If someone wished to enter, he or she would have needed to know in advance how to find the location of the true opening in the wall. Djoser was so proud of his accomplishment that he broke the tradition of having only his own name on the monument and had Imhotep’s name carved on it as well.

E
The burial chamber of the tomb, where the king’s body was laid to rest, was dug beneath the base of the pyramid, surrounded by a vast maze of long tunnels that had rooms off them to discourage robbers. One of the most mysterious discoveries found inside the pyramid was a large number of stone vessels. Over 40,000 of these vessels, of various forms and shapes, were discovered in storerooms off the pyramid’s underground passages. They are inscribed with the names of rulers from the First and Second Dynasties of Egypt and made from different kinds of stone. There is no agreement among scholars and archaeologists on why the vessels were placed in the tomb of Djoser or what they were supposed to represent. The archaeologist Jean-Philippe Lauer, who excavated most of the pyramid and complex, believes they were originally stored and then given a ‘proper burial’ by Djoser in his pyramid to honor his predecessors. There are other historians, however, who claim the vessels were dumped into the shafts as yet another attempt to prevent grave robbers from getting to the king’s burial chamber.

F
Unfortunately, all of the precautions and intricate design of the underground network did not prevent ancient robbers from finding a way in. Djoser’s grave goods, and even his body, were stolen at some point in the past and all archaeologists found were a small number of his valuables overlooked by the thieves. There was enough left throughout the pyramid and its complex, however, to astonish and amaze the archaeologists who excavated it.

G
Egyptologist Miroslav Verner writes, ‘Few monuments hold a place in human history as significant as that of the Step Pyramid in Saqqara … It can be said without exaggeration that this pyramid complex constitutes a milestone in the evolution of monumental stone architecture in Egypt and in the world as a whole.’ The Step Pyramid was a revolutionary advance in architecture and became the archetype which all the other great pyramid builders of Egypt would follow.
        </div>
      </details>

      <div class="q">
        <div class="q-title">Complete the notes (ONE WORD ONLY)</div>

        <p><b>THE STEP PYRAMID OF DJOSER</b></p>

        <div class="q">
          <div class="inline-input">
            <span>1) The complex … is considered to be as big as an Egyptian</span>
            <input type="text" id="t1q1" placeholder="one word" />
            <span>of the past.</span>
          </div>
        </div>

        <div class="q">
          <div class="inline-input">
            <span>2) … accommodation that was occupied by</span>
            <input type="text" id="t1q2" placeholder="one word" />
            <span>, along with many other buildings …</span>
          </div>
        </div>

        <div class="q">
          <div class="inline-input">
            <span>3) … a long</span>
            <input type="text" id="t1q3" placeholder="one word" />
            <span>encircled the wall.</span>
          </div>
        </div>

        <div class="q">
          <div class="inline-input">
            <span>4) … unless they knew the</span>
            <input type="text" id="t1q4" placeholder="one word" />
            <span>of the real entrance.</span>
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <h3>Task 2. Multiple Choice (Qs 5–6) — 2 points</h3>
      <p class="muted">Choose <b>TWO</b> letters (A–E). You cannot choose more than two options.</p>

      <div class="q">
        <div class="q-title">Which TWO points does the writer make about King Djoser?</div>

        <div class="options" id="task2">
          <label><input type="checkbox" value="A">A) Initially he had to be persuaded to build in stone rather than clay.</label>
          <label><input type="checkbox" value="B">B) There is disagreement concerning the length of his reign.</label>
          <label><input type="checkbox" value="C">C) He failed to appreciate Imhotep’s part in the design of the Step Pyramid.</label>
          <label><input type="checkbox" value="D">D) A few of his possessions were still in his tomb when archaeologists found it.</label>
          <label><input type="checkbox" value="E">E) He criticised the design and construction of other pyramids in Egypt.</label>
        </div>

        <p class="muted" style="margin-top:10px;"><b>Note:</b> select exactly 2 options.</p>
      </div>
    </div>

    <!-- PART 2 -->
    <h2>PART 2 — Grammar in Context (Qs 7–11) — 5 points</h2>

    <div class="card" id="part2">
      <p class="muted">For each sentence, choose <b>exactly one</b> option (A–D) that is grammatical and sensible.</p>

      <div class="q">
        <div class="q-title">7. If things had been looked at closer, the miscommunication would have been prevented.</div>
        <div class="options">
          <label><input type="radio" name="q7" value="A">A) was analysed</label>
          <label><input type="radio" name="q7" value="B">B) had been analysed</label>
          <label><input type="radio" name="q7" value="C">C) would be analysed</label>
          <label><input type="radio" name="q7" value="D">D) has been analyzed</label>
        </div>
      </div>

      <div class="q">
        <div class="q-title">8. The results were not as reliable as originally expected.</div>
        <div class="options">
          <label><input type="radio" name="q8" value="A">A) they were</label>
          <label><input type="radio" name="q8" value="B">B) were</label>
          <label><input type="radio" name="q8" value="C">C) had</label>
          <label><input type="radio" name="q8" value="D">D) being</label>
        </div>
      </div>

      <div class="q">
        <div class="q-title">9. She speaks as if she already ________ the outcome.</div>
        <div class="options">
          <label><input type="radio" name="q9" value="A">A) knows</label>
          <label><input type="radio" name="q9" value="B">B) knew</label>
          <label><input type="radio" name="q9" value="C">C) had known</label>
          <label><input type="radio" name="q9" value="D">D) has known</label>
        </div>
      </div>

      <div class="q">
        <div class="q-title">10. The decision has been deferred, amidst reservations over its implications.</div>
        <div class="options">
          <label><input type="radio" name="q10" value="A">A) due</label>
          <label><input type="radio" name="q10" value="B">B) due to</label>
          <label><input type="radio" name="q10" value="C">C) owing</label>
          <label><input type="radio" name="q10" value="D">D) owing for</label>
        </div>
      </div>

      <div class="q">
        <div class="q-title">11. Little is known regarding the long term impact of the change.</div>
        <div class="options">
          <label><input type="radio" name="q11" value="A">A) is known</label>
          <label><input type="radio" name="q11" value="B">B) are known</label>
          <label><input type="radio" name="q11" value="C">C) have known</label>
          <label><input type="radio" name="q11" value="D">D) were known</label>
        </div>
      </div>
    </div>

    <!-- PART 3 -->
    <h2>PART 3 — Open Cloze (Qs 12–15) — 4 points</h2>

    <div class="card">
      <p class="muted">Complete each sentence with <b>ONE WORD ONLY</b>. No additional words or explanations.</p>

      <div class="grid2">
        <div class="q">
          <div class="q-title">12. It is only after the news that the full implications are clear.</div>
          <div class="inline-input">
            <span>→</span>
            <input type="text" id="t3q12" placeholder="one word"/>
          </div>
        </div>

        <div class="q">
          <div class="q-title">13. The proposal was turned down, __________ lacking sufficient evidence.</div>
          <div class="inline-input">
            <span>→</span>
            <input type="text" id="t3q13" placeholder="one word"/>
          </div>
        </div>

        <div class="q">
          <div class="q-title">14. As soon as the statement was made public, public response followed.</div>
          <div class="inline-input">
            <span>→</span>
            <input type="text" id="t3q14" placeholder="one word"/>
          </div>
        </div>

        <div class="q">
          <div class="q-title">15. The changes will come into effect, __________ further notice.</div>
          <div class="inline-input">
            <span>→</span>
            <input type="text" id="t3q15" placeholder="one word"/>
          </div>
        </div>
      </div>

      <div class="final" id="finalLine" style="display:none;">Final score: 0 / 15</div>
    </div>

  </div>

  <script>
    // ===== CONFIG =====
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycby3WsvMVGmXDoOE6vAsS-C_sezurDhPu03c7ek9Rnv7XS4Ept2yU2_FP4Vbu-bO7CRx/exec";

    // ===== Answer key (keep inside JS) =====
    const key = {
      task1: { t1q1: "city", t1q2: "priests", t1q3: "trench", t1q4: "location" },
      task2: new Set(["B","D"]),
      part2: { q7:"B", q8:"B", q9:"C", q10:"B", q11:"A" },
      part3: { t3q12:"did", t3q13:"having", t3q14:"had", t3q15:"pending" }
    };

    function norm(s){ return (s || "").trim().toLowerCase(); }

    function scoreAll(){
      let s1=0;
      for(const id of Object.keys(key.task1)){
        const val = norm(document.getElementById(id).value);
        if(val && val === key.task1[id]) s1++;
      }

      const selected = Array.from(document.querySelectorAll('#task2 input[type="checkbox"]:checked')).map(x=>x.value);
      let s2 = 0;
      if(selected.length === 2){
        const selSet = new Set(selected);
        if(selSet.size === 2 && selSet.has("B") && selSet.has("D")) s2 = 2;
      }

      let sP2=0;
      for(const q of Object.keys(key.part2)){
        const chosen = document.querySelector(`input[name="${q}"]:checked`);
        if(chosen && chosen.value === key.part2[q]) sP2++;
      }

      let sP3=0;
      for(const id of Object.keys(key.part3)){
        const val = norm(document.getElementById(id).value);
        if(val && val === key.part3[id]) sP3++;
      }

      return s1 + s2 + sP2 + sP3;
    }

    // Enforce max 2 choices in Task 2
    const t2Boxes = Array.from(document.querySelectorAll('#task2 input[type="checkbox"]'));
    t2Boxes.forEach(box=>{
      box.addEventListener("change", (e)=>{
        const checked = t2Boxes.filter(b=>b.checked);
        if(checked.length > 2){
          e.target.checked = false;
          alert("You can select only TWO options in Task 2.");
        }
      });
    });

    // Finish: show score + send to Google Sheets
    document.getElementById("btnFinish").addEventListener("click", async ()=>{
      const fullName = document.getElementById("fullName").value.trim();
      const status = document.getElementById("status").value;

      if(!fullName){
        alert("Please enter your Full Name (ФИО).");
        return;
      }
      if(!status){
        alert("Please select your status (student / magistrant / teacher).");
        return;
      }

      const total = scoreAll();

      // Show ONLY total score
      const finalLine = document.getElementById("finalLine");
      finalLine.style.display = "block";
      finalLine.textContent = `Final score: ${total} / 15`;

      // Send result to Google Sheets
      try{
        const payload = {
          fullName,
          status,
          score: total,
          total: 15,
          submittedAt: new Date().toISOString()
        };

        await fetch(SCRIPT_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });

        alert("✅ Your result has been sent!");
      } catch(err){
        console.error(err);
        alert("❌ Error sending result. Please try again.");
      }

      window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
    });

    // Reset
    document.getElementById("btnReset").addEventListener("click", ()=>{
      // Task 1
      for(const id of Object.keys(key.task1)){
        document.getElementById(id).value = "";
      }
      // Task 2
      t2Boxes.forEach(b=>b.checked=false);
      // Part 2
      for(const q of Object.keys(key.part2)){
        const chosen = document.querySelector(`input[name="${q}"]:checked`);
        if(chosen) chosen.checked=false;
      }
      // Part 3
      for(const id of Object.keys(key.part3)){
        document.getElementById(id).value = "";
      }
      document.getElementById("finalLine").style.display="none";
      window.scrollTo({ top: 0, behavior: "smooth" });
    });
  </script>

</body>
</html>
